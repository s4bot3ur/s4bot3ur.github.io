<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Vault Inflation on S4b03ur's Website</title><link>https://s4bot3ur.github.io/tags/vault-inflation/</link><description>Recent content in Vault Inflation on S4b03ur's Website</description><generator>Hugo</generator><language>en-us</language><copyright>Copyright Â© 2024-2025 s4bot3ur. All Rights Reserved.</copyright><lastBuildDate>Wed, 16 Jul 2025 19:41:06 +0530</lastBuildDate><atom:link href="https://s4bot3ur.github.io/tags/vault-inflation/index.xml" rel="self" type="application/rss+xml"/><item><title>R3-CTF-2025-signin</title><link>https://s4bot3ur.github.io/blogs/r3-ctf-2025/signin/</link><pubDate>Wed, 16 Jul 2025 19:41:06 +0530</pubDate><guid>https://s4bot3ur.github.io/blogs/r3-ctf-2025/signin/</guid><description><![CDATA[<h1 id="writeup-for-signin" data-numberify>Writeup for SignIn<a class="anchor ms-1" href="#writeup-for-signin"></a></h1>

<h3 id="challenge-description" data-numberify>Challenge Description<a class="anchor ms-1" href="#challenge-description"></a></h3>
<p>In the world of digital currencies, every transaction holds secrets, and every vault has its own story&hellip;</p>
<p><strong>Author:</strong> zeroc</p>

<h3 id="the-challenge" data-numberify>The Challenge<a class="anchor ms-1" href="#the-challenge"></a></h3>
<p>The below are source contracts</p>
<ol>
<li><strong>Setup</strong> contract</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">// SPDX-License-Identifier: MIT
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="k">pragma solidity</span> <span class="o">^</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">Vault</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;./Vault.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">LING</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;./LING.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="kd">contract</span> <span class="nc">Setup</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">Vault</span> <span class="k">public</span> <span class="n">vault</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">LING</span> <span class="k">public</span> <span class="n">ling</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="kt">bool</span> <span class="k">public</span> <span class="n">claimed</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="kt">bool</span> <span class="k">public</span> <span class="n">solved</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="n">ling</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LING</span><span class="p">(</span><span class="mi">1000</span> <span class="kc">ether</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">vault</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vault</span><span class="p">(</span><span class="n">ling</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="kd">function</span> <span class="nf">claim</span><span class="p">()</span> <span class="k">external</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">claimed</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;Already claimed&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="n">claimed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="nb">transfer</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="mi">1</span> <span class="kc">ether</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="kd">function</span> <span class="nf">solve</span><span class="p">()</span> <span class="k">external</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="n">approve</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="n">vault</span><span class="p">),</span> <span class="mi">999</span> <span class="kc">ether</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">        <span class="n">vault</span><span class="p">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">999</span> <span class="kc">ether</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vault</span><span class="p">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">500</span> <span class="kc">ether</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;Challenge not solved yet&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">        <span class="n">solved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">    <span class="kd">function</span> <span class="nf">isSolved</span><span class="p">()</span> <span class="k">public</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">        <span class="k">return</span> <span class="n">solved</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="2">
<li><strong>LING</strong> contract</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">//SPDX-License-Identifier:MIT
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"></span><span class="k">pragma solidity</span> <span class="o">^</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">ERC20</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;@signin/openzeppelin/contracts/token/ERC20/ERC20.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kd">contract</span> <span class="nc">LING</span> <span class="k">is</span> <span class="n">ERC20</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="kd">constructor</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_initialSupply</span><span class="p">)</span> <span class="n">ERC20</span><span class="p">(</span><span class="s">&#34;LING&#34;</span><span class="p">,</span> <span class="s">&#34;LING&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="n">_mint</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">_initialSupply</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ol start="3">
<li><strong>Vault</strong> contract</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="line"><span class="ln">  1</span><span class="cl"><span class="c1">// SPDX-License-Identifier: MIT
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="c1"></span><span class="k">pragma solidity</span> <span class="o">^</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">.</span><span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  3</span><span class="cl">
</span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">ERC20</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;@signin/openzeppelin/contracts/token/ERC20/ERC20.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">Ownable</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;@signin/openzeppelin/contracts/access/Ownable.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">IERC4626</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;@signin/openzeppelin/contracts/interfaces/IERC4626.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="kn">import</span> <span class="p">{</span><span class="n">LING</span><span class="p">}</span> <span class="k">from</span> <span class="s">&#34;./LING.sol&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl">
</span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="kd">contract</span> <span class="nc">Vault</span> <span class="k">is</span> <span class="n">Ownable</span><span class="p">,</span> <span class="n">IERC4626</span><span class="p">,</span> <span class="n">ERC20</span><span class="p">(</span><span class="s">&#34;LING VAULT&#34;</span><span class="p">,</span> <span class="s">&#34;vLING&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">    <span class="kd">struct</span> <span class="nc">VaultAccount</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">        <span class="kt">uint256</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">    <span class="n">VaultAccount</span> <span class="k">public</span> <span class="n">totalAsset</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">    <span class="n">LING</span> <span class="n">ling</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">    <span class="kd">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint256</span><span class="p">)</span> <span class="k">public</span> <span class="n">borrowedAssets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">    <span class="kt">uint256</span> <span class="k">public</span> <span class="n">totalBorrowedAssets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">    <span class="kd">constructor</span><span class="p">(</span><span class="n">LING</span> <span class="n">_ling</span><span class="p">)</span> <span class="n">Ownable</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">        <span class="n">ling</span> <span class="o">=</span> <span class="n">_ling</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">    <span class="kd">function</span> <span class="nf">asset</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span> <span class="n">assetTokenAddress</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">        <span class="n">assetTokenAddress</span> <span class="o">=</span> <span class="kt">address</span><span class="p">(</span><span class="n">ling</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">    <span class="kd">function</span> <span class="nf">totalAssets</span><span class="p">()</span> <span class="k">public</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">totalManagedAssets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">        <span class="n">totalManagedAssets</span> <span class="o">=</span> <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">-</span> <span class="n">totalBorrowedAssets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">    <span class="kd">function</span> <span class="nf">convertToShares</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">        <span class="kt">uint256</span> <span class="n">assets</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">    <span class="p">)</span> <span class="k">public</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">            <span class="n">shares</span> <span class="o">=</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">            <span class="n">shares</span> <span class="o">=</span> <span class="p">(</span><span class="n">assets</span> <span class="o">*</span> <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span><span class="p">)</span> <span class="o">/</span> <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">    <span class="kd">function</span> <span class="nf">convertToAssets</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">    <span class="p">)</span> <span class="k">public</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">assets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">            <span class="n">assets</span> <span class="o">=</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">            <span class="n">assets</span> <span class="o">=</span> <span class="p">(</span><span class="n">shares</span> <span class="o">*</span> <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span> <span class="o">/</span> <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">    <span class="kd">function</span> <span class="nf">maxDeposit</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">        <span class="kt">address</span> <span class="cm">/* receiver */</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">    <span class="p">)</span> <span class="k">public</span> <span class="k">pure</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">maxAssets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="nc">uint256</span><span class="p">).</span><span class="nb">max</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">    <span class="kd">function</span> <span class="nf">previewDeposit</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">        <span class="kt">uint256</span> <span class="n">assets</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">        <span class="n">shares</span> <span class="o">=</span> <span class="n">convertToShares</span><span class="p">(</span><span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">    <span class="kd">function</span> <span class="nf">deposit</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">        <span class="kt">uint256</span> <span class="n">assets</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">        <span class="kt">address</span> <span class="n">receiver</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">assets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;zero assets&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span> <span class="o">=</span> <span class="n">convertToShares</span><span class="p">(</span><span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">+=</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span> <span class="o">+=</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="n">transferFrom</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">),</span> <span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">        <span class="n">_mint</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">        <span class="n">emit</span> <span class="n">Deposit</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">        <span class="k">return</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">    <span class="kd">function</span> <span class="nf">maxMint</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">        <span class="kt">address</span> <span class="cm">/* receiver */</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">pure</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">maxShares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="nc">uint256</span><span class="p">).</span><span class="nb">max</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">    <span class="kd">function</span> <span class="nf">previewMint</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">assets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">        <span class="n">assets</span> <span class="o">=</span> <span class="n">convertToAssets</span><span class="p">(</span><span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">    <span class="kd">function</span> <span class="nf">mint</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">        <span class="kt">address</span> <span class="n">receiver</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">assets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">shares</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;zero shares&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">        <span class="n">assets</span> <span class="o">=</span> <span class="n">convertToAssets</span><span class="p">(</span><span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl">
</span></span><span class="line"><span class="ln">103</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">+=</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span> <span class="o">+=</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="n">transferFrom</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">),</span> <span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">        <span class="n">_mint</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="n">emit</span> <span class="n">Deposit</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">        <span class="k">return</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">
</span></span><span class="line"><span class="ln">112</span><span class="cl">    <span class="kd">function</span> <span class="nf">maxWithdraw</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">        <span class="kt">address</span> <span class="n">owner</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">maxAssets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span> <span class="o">=</span> <span class="n">balanceOf</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl">        <span class="n">maxAssets</span> <span class="o">=</span> <span class="n">convertToAssets</span><span class="p">(</span><span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">
</span></span><span class="line"><span class="ln">119</span><span class="cl">    <span class="kd">function</span> <span class="nf">previewWithdraw</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">        <span class="kt">uint256</span> <span class="n">assets</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">        <span class="n">shares</span> <span class="o">=</span> <span class="n">convertToShares</span><span class="p">(</span><span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">
</span></span><span class="line"><span class="ln">125</span><span class="cl">    <span class="kd">function</span> <span class="nf">withdraw</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">        <span class="kt">uint256</span> <span class="n">assets</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">        <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">        <span class="kt">address</span> <span class="n">owner</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">assets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;zero assets&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">        <span class="n">shares</span> <span class="o">=</span> <span class="n">convertToShares</span><span class="p">(</span><span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">shares</span> <span class="o">&gt;</span> <span class="n">balanceOf</span><span class="p">(</span><span class="n">owner</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;insufficient shares&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">
</span></span><span class="line"><span class="ln">138</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span> <span class="o">!=</span> <span class="n">owner</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">            <span class="kt">uint256</span> <span class="n">allowed</span> <span class="o">=</span> <span class="n">allowance</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">allowed</span> <span class="o">&lt;</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl">                <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;insufficient allowance&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">142</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl">            <span class="n">_approve</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">allowed</span> <span class="o">-</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl">
</span></span><span class="line"><span class="ln">146</span><span class="cl">        <span class="n">_burn</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">-=</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">148</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span> <span class="o">-=</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">149</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="nb">transfer</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">150</span><span class="cl">
</span></span><span class="line"><span class="ln">151</span><span class="cl">        <span class="n">emit</span> <span class="n">Withdraw</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl">        <span class="k">return</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">154</span><span class="cl">
</span></span><span class="line"><span class="ln">155</span><span class="cl">    <span class="kd">function</span> <span class="nf">maxRedeem</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl">        <span class="kt">address</span> <span class="n">owner</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">maxShares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">158</span><span class="cl">        <span class="k">return</span> <span class="n">balanceOf</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">160</span><span class="cl">
</span></span><span class="line"><span class="ln">161</span><span class="cl">    <span class="kd">function</span> <span class="nf">previewRedeem</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span>
</span></span><span class="line"><span class="ln">163</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">assets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl">        <span class="n">assets</span> <span class="o">=</span> <span class="n">convertToAssets</span><span class="p">(</span><span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">165</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">166</span><span class="cl">
</span></span><span class="line"><span class="ln">167</span><span class="cl">    <span class="kd">function</span> <span class="nf">redeem</span><span class="p">(</span>
</span></span><span class="line"><span class="ln">168</span><span class="cl">        <span class="kt">uint256</span> <span class="n">shares</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl">        <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">170</span><span class="cl">        <span class="kt">address</span> <span class="n">owner</span>
</span></span><span class="line"><span class="ln">171</span><span class="cl">    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">assets</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">172</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">shares</span> <span class="o">&gt;</span> <span class="n">balanceOf</span><span class="p">(</span><span class="n">owner</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">173</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;insufficient shares&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">174</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">175</span><span class="cl">        <span class="n">assets</span> <span class="o">=</span> <span class="n">convertToAssets</span><span class="p">(</span><span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">176</span><span class="cl">
</span></span><span class="line"><span class="ln">177</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span> <span class="o">!=</span> <span class="n">owner</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">178</span><span class="cl">            <span class="kt">uint256</span> <span class="n">allowed</span> <span class="o">=</span> <span class="n">allowance</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">179</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">allowed</span> <span class="o">&lt;</span> <span class="n">shares</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">180</span><span class="cl">                <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;insufficient allowance&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">181</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">182</span><span class="cl">            <span class="n">_approve</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">allowed</span> <span class="o">-</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">183</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">184</span><span class="cl">
</span></span><span class="line"><span class="ln">185</span><span class="cl">        <span class="n">_burn</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">186</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">-=</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">187</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">shares</span> <span class="o">-=</span> <span class="n">shares</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">188</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="nb">transfer</span><span class="p">(</span><span class="n">receiver</span><span class="p">,</span> <span class="n">assets</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">189</span><span class="cl">
</span></span><span class="line"><span class="ln">190</span><span class="cl">        <span class="n">emit</span> <span class="n">Withdraw</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">shares</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">191</span><span class="cl">        <span class="k">return</span> <span class="n">assets</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">192</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">193</span><span class="cl">
</span></span><span class="line"><span class="ln">194</span><span class="cl">    <span class="kd">function</span> <span class="nf">borrowAssets</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">external</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">195</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">196</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;zero amount&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">197</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">198</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="o">&gt;</span> <span class="n">totalAssets</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">199</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;insufficient balance&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">200</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">201</span><span class="cl">        <span class="n">borrowedAssets</span><span class="p">[</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">202</span><span class="cl">        <span class="n">totalBorrowedAssets</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">203</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="nb">transfer</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">204</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">205</span><span class="cl">
</span></span><span class="line"><span class="ln">206</span><span class="cl">    <span class="kd">function</span> <span class="nf">repayAssets</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">external</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">207</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">amount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">208</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;zero amount&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">209</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">210</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">borrowedAssets</span><span class="p">[</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">211</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;invalid amount&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">212</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">213</span><span class="cl">        <span class="kt">uint256</span> <span class="n">fee</span> <span class="o">=</span> <span class="p">(</span><span class="n">amount</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">214</span><span class="cl">        <span class="n">borrowedAssets</span><span class="p">[</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">215</span><span class="cl">        <span class="n">totalBorrowedAssets</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">216</span><span class="cl">        <span class="n">totalAsset</span><span class="p">.</span><span class="n">amount</span> <span class="o">+=</span> <span class="n">fee</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">217</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="n">transferFrom</span><span class="p">(</span><span class="nb">msg</span><span class="p">.</span><span class="nb">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">),</span> <span class="n">amount</span> <span class="o">+</span> <span class="n">fee</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">218</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">219</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="line"><span class="ln">1</span><span class="cl">    <span class="kd">function</span> <span class="nf">solve</span><span class="p">()</span> <span class="k">external</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">        <span class="n">ling</span><span class="p">.</span><span class="n">approve</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="n">vault</span><span class="p">),</span> <span class="mi">999</span> <span class="kc">ether</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="n">vault</span><span class="p">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">999</span> <span class="kc">ether</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">));</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">vault</span><span class="p">.</span><span class="n">balanceOf</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">500</span> <span class="kc">ether</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">            <span class="nb">revert</span><span class="p">(</span><span class="s">&#34;Challenge not solved yet&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">        <span class="n">solved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>Our goal is to make the <code>Setup::isSolved</code> function return <code>true</code>. This function returns <code>true</code> if the <code>solved</code> variable is set to <code>true</code>. We can set <code>solved</code> to <code>true</code> by calling <code>Setup::solve</code>. The <code>Setup::solve</code> function attempts to deposit <code>999e18</code> <strong>LING</strong> tokens into the vault. If, during this deposit, the number of shares received by the <code>Setup</code> contract is <strong>less than 500 ether</strong>, the <code>solved</code> variable will be set to true.</p>]]></description></item></channel></rss>